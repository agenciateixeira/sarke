(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{735:(e,r,a)=>{"use strict";a.d(r,{AuthProvider:()=>c,A:()=>u});var t=a(5155),s=a(2115),i=a(5497);let o="https://eaphfgwyiaqelppopcrt.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVhcGhmZ3d5aWFxZWxwcG9wY3J0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzNjE3NTgsImV4cCI6MjA4NDkzNzc1OH0.J7iQGpIhkquMjSSVHmsNtSUGFqA310-irjvkT2vSgks";if(!o||!l)throw Error("Missing Supabase environment variables");let n=(0,i.UU)(o,l),d=(0,s.createContext)(void 0),c=e=>{let{children:r}=e,[a,i]=(0,s.useState)(null),[o,l]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{n.auth.getSession().then(e=>{var r;let{data:{session:a}}=e;l(null!=(r=null==a?void 0:a.user)?r:null),(null==a?void 0:a.user)?h(a.user.id):u(!1)});let{data:{subscription:e}}=n.auth.onAuthStateChange((e,r)=>{var a;l(null!=(a=null==r?void 0:r.user)?a:null),(null==r?void 0:r.user)?h(r.user.id):(i(null),u(!1))});return()=>e.unsubscribe()},[]);let h=async e=>{try{let{data:r,error:a}=await n.from("profiles").select("*").eq("id",e).single();if(a)throw a;i(r)}catch(e){console.error("Error loading user profile:",e)}finally{u(!1)}},m=async(e,r)=>{try{let{error:a}=await n.auth.signInWithPassword({email:e,password:r});if(a)throw a;return{}}catch(e){return{error:e.message}}},f=async(e,r,a,t)=>{try{let{data:s,error:i}=await n.auth.signUp({email:e,password:r});if(i)throw i;if(!s.user)throw Error("Failed to create user");let{error:o}=await n.from("profiles").insert({id:s.user.id,email:e,name:a,role:t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(o)throw o;return{}}catch(e){return{error:e.message}}},x=async()=>{await n.auth.signOut(),i(null),l(null)},p=async e=>{if(a)try{let{error:r}=await n.from("profiles").update({...e,updated_at:new Date().toISOString()}).eq("id",a.id);if(r)throw r;i({...a,...e})}catch(e){console.error("Error updating profile:",e)}};return(0,t.jsx)(d.Provider,{value:{user:a,supabaseUser:o,loading:c,signIn:m,signUp:f,signOut:x,updateProfile:p},children:r})},u=()=>{let e=(0,s.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1175:(e,r,a)=>{Promise.resolve().then(a.bind(a,5114))},1771:(e,r,a)=>{"use strict";a.d(r,{YL:()=>i,_m:()=>s});let t={admin:["dashboard","tarefas","comercial","financeiro","juridico","calendario","gestao_equipe","chat_interno","ferramentas","gestao_obra","cronograma","memorial"],gerente:["dashboard","tarefas","calendario","chat_interno","ferramentas","gestao_obra","cronograma","memorial"],colaborador:["dashboard","tarefas","calendario","chat_interno"],juridico:["dashboard","juridico","calendario","chat_interno"]},s=(e,r)=>{var a,s;return null!=(s=null==(a=t[e])?void 0:a.includes(r))&&s},i=e=>{if("admin"===e.role||!e.horario_inicio||!e.horario_fim)return!0;let r=new Date,a=r.getDay(),t="".concat(r.getHours().toString().padStart(2,"0"),":").concat(r.getMinutes().toString().padStart(2,"0"));return(!e.dias_trabalho||!!e.dias_trabalho.includes(a))&&t>=e.horario_inicio&&t<=e.horario_fim}},4962:(e,r,a)=>{"use strict";a.d(r,{U:()=>n});var t=a(5155),s=a(7494),i=a(9427),o=a(7106),l=a(7003);let n=()=>{let{theme:e,toggleTheme:r}=(0,o.D)();return(0,t.jsx)(l.$,{variant:"outline",size:"icon",onClick:r,className:"rounded-full","aria-label":"Alternar tema",children:"light"===e?(0,t.jsx)(s.A,{className:"h-5 w-5"}):(0,t.jsx)(i.A,{className:"h-5 w-5"})})}},5016:(e,r,a)=>{"use strict";a.d(r,{cn:()=>i});var t=a(2821),s=a(5889);function i(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,s.QP)((0,t.$)(r))}},5114:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>M});var t=a(5155),s=a(5674),i=a(2619),o=a.n(i),l=a(63),n=a(735),d=a(1771),c=a(5016),u=a(9384),h=a(1194),m=a(512),f=a(1761),x=a(5843),p=a(6485),b=a(1169),g=a(7586),v=a(3842),j=a(1871),w=a(7066),N=a(9715),y=a(4926),_=a(7003),S=a(2115),A=a(9780);let k=S.forwardRef((e,r)=>{let{className:a,children:s,...i}=e;return(0,t.jsxs)(A.bL,{ref:r,className:(0,c.cn)("relative overflow-hidden",a),...i,children:[(0,t.jsx)(A.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,t.jsx)(I,{}),(0,t.jsx)(A.OK,{})]})});k.displayName=A.bL.displayName;let I=S.forwardRef((e,r)=>{let{className:a,orientation:s="vertical",...i}=e;return(0,t.jsx)(A.VM,{ref:r,orientation:s,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...i,children:(0,t.jsx)(A.lr,{className:"relative flex-1 rounded-full bg-border"})})});I.displayName=A.VM.displayName;var C=a(9215);let E=S.forwardRef((e,r)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...o}=e;return(0,t.jsx)(C.b,{ref:r,decorative:i,orientation:s,className:(0,c.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...o})});E.displayName=C.b.displayName;var O=a(6746);let z=S.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(O.bL,{ref:r,className:(0,c.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});z.displayName=O.bL.displayName,S.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(O._V,{ref:r,className:(0,c.cn)("aspect-square h-full w-full",a),...s})}).displayName=O._V.displayName;let J=S.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)(O.H4,{ref:r,className:(0,c.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});J.displayName=O.H4.displayName;var q=a(4962);let F=[{title:"Dashboard",href:"/dashboard",icon:(0,t.jsx)(u.A,{className:"h-5 w-5"}),setor:"dashboard"},{title:"Tarefas",href:"/dashboard/tarefas",icon:(0,t.jsx)(h.A,{className:"h-5 w-5"}),setor:"tarefas"},{title:"Comercial",href:"/dashboard/comercial",icon:(0,t.jsx)(m.A,{className:"h-5 w-5"}),setor:"comercial"},{title:"Financeiro",href:"/dashboard/financeiro",icon:(0,t.jsx)(f.A,{className:"h-5 w-5"}),setor:"financeiro"},{title:"Jur\xeddico",href:"/dashboard/juridico",icon:(0,t.jsx)(x.A,{className:"h-5 w-5"}),setor:"juridico"},{title:"Calend\xe1rio",href:"/dashboard/calendario",icon:(0,t.jsx)(p.A,{className:"h-5 w-5"}),setor:"calendario"},{title:"Gest\xe3o de Equipe",href:"/dashboard/equipe",icon:(0,t.jsx)(b.A,{className:"h-5 w-5"}),setor:"gestao_equipe"},{title:"Chat Interno",href:"/dashboard/chat",icon:(0,t.jsx)(g.A,{className:"h-5 w-5"}),setor:"chat_interno"},{title:"Ferramentas",href:"/dashboard/ferramentas",icon:(0,t.jsx)(v.A,{className:"h-5 w-5"}),setor:"ferramentas"},{title:"Gest\xe3o de Obra",href:"/dashboard/obra",icon:(0,t.jsx)(j.A,{className:"h-5 w-5"}),setor:"gestao_obra"},{title:"Cronograma",href:"/dashboard/cronograma",icon:(0,t.jsx)(w.A,{className:"h-5 w-5"}),setor:"cronograma"},{title:"Memorial",href:"/dashboard/memorial",icon:(0,t.jsx)(N.A,{className:"h-5 w-5"}),setor:"memorial"}],L=()=>{let{user:e,signOut:r}=(0,n.A)(),a=(0,l.usePathname)();if(!e)return null;let s=F.filter(r=>(0,d._m)(e.role,r.setor));return(0,t.jsxs)("div",{className:"flex h-screen w-64 flex-col border-r bg-card",children:[(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-6 border-b",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Sarke"}),(0,t.jsx)(q.U,{})]}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 rounded-lg bg-muted p-3",children:[(0,t.jsx)(z,{children:(0,t.jsx)(J,{children:e.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["admin"===e.role&&"Administrador","gerente"===e.role&&"Gerente","colaborador"===e.role&&"Colaborador","juridico"===e.role&&"Jur\xeddico"]})]})]})}),(0,t.jsx)(E,{}),(0,t.jsx)(k,{className:"flex-1 px-3 py-2",children:(0,t.jsx)("div",{className:"space-y-1",children:s.map(e=>(0,t.jsxs)(o(),{href:e.href,className:(0,c.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-colors",a===e.href?"bg-primary text-primary-foreground":"hover:bg-muted"),children:[e.icon,(0,t.jsx)("span",{children:e.title})]},e.href))})}),(0,t.jsx)(E,{}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)(_.$,{variant:"outline",className:"w-full justify-start gap-3",onClick:()=>r(),children:[(0,t.jsx)(y.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Sair"})]})})]})};function M(e){let{children:r}=e;return(0,t.jsx)(s.O,{children:(0,t.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[(0,t.jsx)(L,{}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto bg-background",children:r})]})})}},5674:(e,r,a)=>{"use strict";a.d(r,{O:()=>n});var t=a(5155),s=a(2115),i=a(63),o=a(735),l=a(1771);let n=e=>{let{children:r,requiredRole:a,requiredSetor:n}=e,{user:d,loading:c}=(0,o.A)(),u=(0,i.useRouter)();return((0,s.useEffect)(()=>{if(!c){if(!d)return void u.push("/login");if(a&&!a.includes(d.role)||n&&!(0,l._m)(d.role,n))return void u.push("/dashboard");if("admin"!==d.role&&!(0,l.YL)(d))return void u.push("/fora-horario")}},[d,c,a,n,u]),c)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):d&&(!a||a.includes(d.role))&&(!n||(0,l._m)(d.role,n))?(0,t.jsx)(t.Fragment,{children:r}):null}},7003:(e,r,a)=>{"use strict";a.d(r,{$:()=>n});var t=a(5155),s=a(2115),i=a(3101),o=a(5016);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),n=s.forwardRef((e,r)=>{let{className:a,variant:s,size:i,...n}=e;return(0,t.jsx)("button",{className:(0,o.cn)(l({variant:s,size:i,className:a})),ref:r,...n})});n.displayName="Button"},7106:(e,r,a)=>{"use strict";a.d(r,{D:()=>l,ThemeProvider:()=>o});var t=a(5155),s=a(2115);let i=(0,s.createContext)(void 0),o=e=>{let{children:r}=e,[a,o]=(0,s.useState)("light"),[l,n]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{n(!0);let e=localStorage.getItem("sarke-theme");e?o(e):o(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},[]),(0,s.useEffect)(()=>{if(!l)return;let e=window.document.documentElement;e.classList.remove("light","dark"),e.classList.add(a),localStorage.setItem("sarke-theme",a)},[a,l]),l)?(0,t.jsx)(i.Provider,{value:{theme:a,toggleTheme:()=>{o(e=>"light"===e?"dark":"light")},setTheme:e=>{o(e)}},children:r}):(0,t.jsx)(t.Fragment,{children:r})},l=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}}},e=>{e.O(0,[779,497,824,441,255,358],()=>e(e.s=1175)),_N_E=e.O()}]);